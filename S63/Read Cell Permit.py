
from funcs import *
    
clearConsole()

#CellPrtmit = 'NO4D061320000830BEB9BFE3C7C6CE68B16411FD09F96982795C77B204F54D48' 
#NO4D0613 20000830 BEB9BFE3C7C6CE68 B16411FD09F9698 2795C77B204F54D48
#CellPrtmit = 'GB40162A20181231F81AC653B0AB63B0F81AC653B0AB63B09DE31FB609E17492,0,1,GB,Comment'
#GB40162A 20181231 F81AC653B0AB63B0 F81AC653B0AB63B0 9DE31FB609E17492,0,1,GB,'

#CellPrtmit = 'GB1000042018123164B51D24FB77ADB364B51D24FB77ADB390432733F4F4D403,0,1,GB,Comment'
#ID = '12345'

#QNLZ
#M_KEY: 201351 31287 (3331323837) HW_ID: 28701 (3238373031)
#GB307702 20220331 4209D1C0F1FEA71D 4209D1C0F1FEA71D 08CE6364D8F84166
CellPrtmit = 'GB307702202203314209D1C0F1FEA71D4209D1C0F1FEA71D08CE6364D8F84166,0,2,GB,'
ID = '28701'
#CK1 == E8A63CD6F2??

#DFDR
#GB307702 20220331 523BD9B97FBB3A8A 523BD9B97FBB3A8A8 C1EAC8F89FD1451,0,2,GB,
#M_KEY: 
#CellPrtmit = 'GB30770220220331523BD9B97FBB3A8A523BD9B97FBB3A8A8C1EAC8F89FD1451,0,2,GB,'
#ID = ''
#CK1 == E8A63CD6F2??

# Manufacturer ID: (M_ID) = 10 (or 3130 hexadecimal)Manufacturer 
# Key: (M_KEY) = 10121 (or 3130313231 hexadecimal)Hardware 
# ID: (HW_ID) = 12345 (or 3132333435 hexadecimal)
# USERPERMIT = 66B5CBFDF7E4139D5B6086C23130

HW_ID = hexToASCiiPair(ID) #'3132333435' #5 bytes in hexadecimal
HW_ID6 = HW_ID + HW_ID[:2]

Cell_Name = CellPrtmit[0:8]
Expiry_Date = CellPrtmit[8:16]
ECK1 = CellPrtmit[16:32]
ECK2 = CellPrtmit[32:48]
CRC = CellPrtmit[48:64]
ServiceLevelIndicator = CellPrtmit[65:66]
EditionNumber = CellPrtmit[67:68]
DataServerID = CellPrtmit[69:71]
Comment = CellPrtmit[72:]

cipher = blowfish.Cipher(bytes.fromhex(HW_ID6))
CK1 = decryptCy(cipher, ECK1)
CK2 = decryptCy(cipher, ECK2)

print("CK1, CK2:",CK1, CK2)
